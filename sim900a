#include <SoftwareSerial.h>
SoftwareSerial SIM900A(10, 11);
const int gasSensorPin = A0;
const int buzzerPin = 8; 
const int gasThreshold = 800; 
bool gasLeakage = false;
void setup()
{
  SIM900A.begin(9600);    
  Serial.begin(9600);    
  Serial.println ("SIM900A Ready");
  pinMode(buzzerPin, OUTPUT); 
  digitalWrite(buzzerPin, LOW); y
  delay(50);
}
void loop()
{
  
  int gasValue = analogRead(gasSensorPin);
  Serial.print("Gas Sensor Reading: ");
  Serial.println(gasValue);
  if (gasValue > gasThreshold)
  {
    if (!gasLeakage) {
      SendMessage("Gas Leakage Detected!");
      gasLeakage = true;
    }
    ActivateBuzzer();
  }
  else
  {
    if (gasLeakage) {
      SendMessage("No Gas Leakage Detected.");
      gasLeakage = false;
    }
    digitalWrite(buzzerPin, LOW);
  }
  if (SIM900A.available() > 0)
    Serial.write(SIM900A.read());
  delay(1000); 
}
void SendMessage(String message)
{
  Serial.println ("Sending Message");
  SIM900A.println("AT+CMGF=1");   
  delay(1000);
  Serial.println ("Set SMS Number");
  SIM900A.println("AT+CMGS=\"+919696969696\"\r"); 
  delay(1000);
  Serial.println ("Set SMS Content");
  SIM900A.println(message);
  delay(100);
  Serial.println ("Finish");
  SIM900A.println((char)26);
  delay(1000);
  Serial.println ("Message has been sent ->SMS Selesai dikirim");
}
void ActivateBuzzer()
{
  digitalWrite(buzzerPin, HIGH);
}
